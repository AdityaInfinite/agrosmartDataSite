<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
	<script src="Utils.js"></script>
</head>

<body>
	<input type="text" id="pathinput" style="width: 300px;">
	<input type="button" value="submit" onclick="submitted()">
	<canvas id="myChart" width="400" height="100"></canvas>
</body>
<script>
	function submitted(){
		setup();
	}
	async function setup() {
		const ctx = document.getElementById('myChart').getContext('2d');
		const globalTemps = await getData();
		const myChart = new Chart(ctx, {
			type: 'line',
			data: {
				labels: globalTemps.years,
				datasets: [
					{
						label: 'soil moisture',
						data: globalTemps.val0,
						fill: false,
						borderColor: 'rgba(255, 99, 132, 1)',
						backgroundColor: 'rgba(255, 99, 132, 0.5)',
						borderWidth: 1
					},
					{
						label: 'soil moisture',
						data: globalTemps.val1,
						fill: false,
						borderColor: 'rgba(255, 99, 132, 1)',
						backgroundColor: 'rgba(255, 99, 132, 0.5)',
						borderWidth: 1
					}
				]
			},
			options: {}
		});
	}
	async function getData() {
      // const response = await fetch('testdata.csv');
      const response = await fetch(document.getElementById('pathinput').value);
      const data = await response.text();
      const years = [];
      const val0 = [];
	  const val1 = [];
      const rows = data.split('\n').slice(1);
      rows.forEach(row => {
        const cols = row.split(',');
        years.push(cols[0]);
        val0.push(parseFloat(cols[1]));
		val1.push(parseFloat(cols[2]));
      });
      return { years, val0 ,val1};
    }
</script>

</html>